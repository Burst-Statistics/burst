jQuery(document).ready((function(t){"use strict";function e(e,a){e=void 0!==e?e:parseInt(t("input[name=burst_date_start]").val()),a=void 0!==a?a:parseInt(t("input[name=burst_date_end]").val());window.config={type:"line",data:{labels:["...","...","...","...","...","...","..."],datasets:[{label:"Loading...",backgroundColor:"rgb(41, 182, 246)",borderColor:"rgb(41, 182, 246)",data:[0,0,0,0,0,0,0],fill:!1}]},options:{legend:{display:!0},responsive:!0,maintainAspectRatio:!1,title:{display:!1,text:"Select"},tooltips:{mode:"index",intersect:!0,enabled:!0,position:"nearest"},hover:{mode:"index",intersect:!0},scales:{xAxes:[{display:!0,offset:!0,scaleLabel:{display:!1}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Loading..."},ticks:{beginAtZero:!0,min:0,max:10,stepSize:5}}]}}};let n=document.getElementsByClassName("burst-chartjs-stats");null!=window.conversionGraph&&window.conversionGraph.destroy(),window.conversionGraph=new Chart(n,window.config);let s=JSON.parse(t("input[name=burst_chartjs_metrics]").val());t.ajax({type:"get",dataType:"json",url:burst.ajaxurl,data:{action:"burst_get_chart_statistics",date_start:e,date_end:a,metrics:s},success:function(t){if(1==t.success){let e=0;t.data.datasets.forEach((function(t){if(window.config.data.datasets.hasOwnProperty(e))window.config.data.datasets[e]=t;else{let e=t;window.config.data.datasets.push(e)}e++})),window.config.data.labels=t.data.labels,window.config.data.dates=t.data.dates,window.config.options.title.text=t.title,window.config.options.scales.yAxes[0].ticks.max=parseInt(t.data.max),window.config.options.scales.yAxes[0].scaleLabel.labelString=t.options.scales.yAxes[0].scaleLabel,window.conversionGraph.update()}else alert("Your data could not be loaded")},error:function(t){console.log(t)}})}function a(){t(".burst-load-ajax").each((function(){let e=t(this);0==e.find(".burst-skeleton").length&&e.find(".burst-grid-content").fadeOut(200,(function(){t(this).html('<div class="burst-skeleton"></div>').fadeIn(300)}));let a=e.data("block_type"),n=parseInt(t("input[name=burst_date_start]").val()),s=parseInt(t("input[name=burst_date_end]").val());console.log("burstLoadGridBlocks"),console.log({date_start:n}),console.log({date_end:s}),t.ajax({type:"get",dataType:"json",url:burst.ajaxurl,data:{action:"burst_load_grid_block",type:a,date_start:n,date_end:s},success:function(a){console.log({response:a}),a.success&&(console.log({response:a}),e.find(".burst-grid-content").fadeOut(300,(function(){t(this).html(a.html).fadeIn(200)})))}})}))}function n(e,a){t(".burst-date-container span").html(e.format("MMMM D, YYYY")+" - "+a.format("MMMM D, YYYY"))}!function(){moment().endOf("day").subtract(1,"days").add(1,"minutes");let s=moment().endOf("day"),r=moment().endOf("day").subtract(2,"days").add(1,"minutes"),o=moment().endOf("day").subtract(1,"days"),i=burstLocalizeString("Yesterday"),l=burstLocalizeString("Previous 7 days"),d=burstLocalizeString("Previous 30 days"),u=burstLocalizeString("Previous 90 days"),c=burstLocalizeString("Previous Month")+" ("+moment().subtract(1,"month").format("MMMM")+")",b={};b[i]=[r,o],b[l]=[moment().subtract(8,"days"),o],b[d]=[moment().subtract(32,"days"),o],b[u]=[moment().subtract(92,"days"),o],b[c]=[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")];let g=parseInt(t("input[name=burst_date_start]").val()),m=parseInt(t("input[name=burst_date_end]").val());null!==g&&null!==m||(g=moment().endOf("day").subtract(8,"days").unix(),m=moment().endOf("day").subtract(1,"day").unix());g=parseInt(g),m=parseInt(m),n(moment.unix(g),moment.unix(m)),e(),t(".burst-date-container.burst-date-range").daterangepicker({ranges:b,locale:{format:burstLocalizeString("date_format","burst"),separator:" - ",applyLabel:burstLocalizeString("Apply","burst"),cancelLabel:burstLocalizeString("Cancel","burst"),fromLabel:burstLocalizeString("From","burst"),toLabel:burstLocalizeString("To","burst"),customRangeLabel:burstLocalizeString("Custom","burst"),weekLabel:burstLocalizeString("W","burst"),daysOfWeek:[burstLocalizeString("Su","burst"),burstLocalizeString("Mo","burst"),burstLocalizeString("Tu","burst"),burstLocalizeString("We","burst"),burstLocalizeString("Th","burst"),burstLocalizeString("Fr","burst"),burstLocalizeString("Sa","burst")],monthNames:[burstLocalizeString("January"),burstLocalizeString("February"),burstLocalizeString("March"),burstLocalizeString("April"),burstLocalizeString("May"),burstLocalizeString("June"),burstLocalizeString("July"),burstLocalizeString("August"),burstLocalizeString("September"),burstLocalizeString("October"),burstLocalizeString("November"),burstLocalizeString("December")],firstDay:1},alwaysShowCalendars:!0,startDate:moment.unix(g),endDate:moment.unix(m),opens:"left",maxDate:s},(function(s,r,o){n(s,r),e(s.unix(),r.unix()),t("input[name=burst_date_start]").val(s.unix()),t("input[name=burst_date_end]").val(r.unix()),a(),window.burstLoadAjaxTables()}))}(),t(document).on("change","select[name=burst_selected_metric]",(function(){let a=t(".burst-date-container.burst-date-range").data("daterangepicker"),n=moment(a.startDate),s=moment(a.endDate);e(n.unix(),s.unix())})),a();let s=0;t(window).on("resize",(function(){})),window.burstLoadAjaxTables=function(){t(".burst-grid-datatable").each((function(){0==t(this).find(".burst-skeleton").length&&t(this).find(".burst-grid-content").fadeOut(200,(function(){t(this).html('<div class="burst-skeleton"></div>').fadeIn(300)})),r(t(this),t(this).data("id"),1,0),console.log("loop")}))},window.burstLoadAjaxTables();array();function r(e,a,n,o){1===n&&e.html(burst.skeleton);let i=parseInt(t("input[name=burst_date_start]").val()),l=parseInt(t("input[name=burst_date_end]").val()),d=e.data("block_type");console.log(d),t.ajax({type:"GET",url:burst.ajaxurl,dataType:"json",data:{action:"burst_get_datatable",start:i,end:l,page:n,type:d},success:function(i){if(console.log(i),1===n){let n=e.find("table");e.find(".burst-skeleton").fadeOut(300,(function(){n.hide().html(i.html).fadeIn(200),n.DataTable().destroy(),e.find(".dataTables_length").remove(),e.find(".dataTables_filter").remove(),e.find(".dataTables_info").remove(),e.find(".dataTables_paginate").remove(),function(e,a){t(window),e.DataTable({id:a,pageLength:10,pagingType:"simple_numbers",conditionalPaging:!0,columns:[{width:"75%"},{width:"25%"}],language:{paginate:{previous:burstLocalizeString("Previous"),next:burstLocalizeString("Next")},searchPlaceholder:burstLocalizeString("Search"),search:"",emptyTable:burstLocalizeString("No data available")},order:[[1,"desc"]]}),e.on("page.dt",(function(){let e=t(this).closest("table").DataTable().page.info();s=e.page}))}(n,a),e.find(".dataTables_length").appendTo(e.find(".burst-grid-controls")),e.find(".dataTables_filter").appendTo(e.find(".burst-grid-controls")),e.find(".dataTables_info").appendTo(e.find(".burst-grid-footer")),e.find(".dataTables_paginate").appendTo(e.find(".burst-grid-footer"))}))}else{let a=e.find("table").DataTable(),n=i.html.length;for(let e in i.html)if(i.html.hasOwnProperty(e)){let r=t(i.html[e]);parseInt(e)>=n-1?(a.row.add(r).draw(),a.page(s).draw(!1)):a.row.add(r)}}o+=i.batch,i.total_rows>o?(n++,r(e,n,o)):n=1}})}}));
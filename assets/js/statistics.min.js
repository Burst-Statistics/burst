jQuery(document).ready((function(t){"use strict";function a(a,e){a=void 0!==a?a:parseInt(t("input[name=burst_date_start]").val()),e=void 0!==e?e:parseInt(t("input[name=burst_date_end]").val());window.config={type:"line",data:{labels:["...","...","...","...","...","...","..."],datasets:[{label:"Loading...",backgroundColor:"rgb(41, 182, 246)",borderColor:"rgb(41, 182, 246)",data:[0,0,0,0,0,0,0],fill:!1}]},options:{legend:{display:!0},responsive:!0,maintainAspectRatio:!1,title:{display:!1,text:"Select"},tooltips:{mode:"index",intersect:!0,enabled:!0,position:"nearest"},hover:{mode:"index",intersect:!0},scales:{xAxes:[{display:!0,offset:!0,scaleLabel:{display:!1}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Loading..."},ticks:{beginAtZero:!0,min:0,max:10,stepSize:5}}]}}};let n=document.getElementsByClassName("burst-chartjs-stats");null!=window.conversionGraph&&window.conversionGraph.destroy(),window.conversionGraph=new Chart(n,window.config);let s=JSON.parse(t("input[name=burst_chartjs_metrics]").val());t.ajax({type:"get",dataType:"json",url:burst.ajaxurl,data:{action:"burst_get_chart_statistics",date_start:a,date_end:e,metrics:s},success:function(t){if(1==t.success){let a=0;t.data.datasets.forEach((function(t){if(window.config.data.datasets.hasOwnProperty(a))window.config.data.datasets[a]=t;else{let a=t;window.config.data.datasets.push(a)}a++})),window.config.data.labels=t.data.labels,window.config.data.dates=t.data.dates,window.config.options.title.text=t.title,window.config.options.scales.yAxes[0].ticks.max=parseInt(t.data.max),window.config.options.scales.yAxes[0].scaleLabel.labelString=t.options.scales.yAxes[0].scaleLabel,window.conversionGraph.update()}else alert("Your data could not be loaded")},error:function(t){console.log(t)}})}function e(){t(".burst-load-ajax").each((function(){let a=t(this);0==a.find(".burst-skeleton").length&&a.find(".burst-grid-content").fadeOut(200,(function(){t(this).html('<div class="burst-skeleton"></div>').fadeIn(300)}));let e=a.data("block_type"),n=parseInt(t("input[name=burst_date_start]").val()),s=parseInt(t("input[name=burst_date_end]").val());t.ajax({type:"get",dataType:"json",url:burst.ajaxurl,data:{action:"burst_load_grid_block",type:e,date_start:n,date_end:s},success:function(e){e.success&&a.find(".burst-grid-content").fadeOut(300,(function(){t(this).html(e.html).fadeIn(200)}))}})}))}function n(a,e){t(".burst-date-container span").html(a.format("MMMM D, YYYY")+" - "+e.format("MMMM D, YYYY"))}!function(){moment().endOf("day").subtract(1,"days").add(1,"minutes");let s=moment().endOf("day"),r=moment().endOf("day").subtract(2,"days").add(1,"minutes"),i=moment().endOf("day").subtract(1,"days"),o=burstLocalizeString("Yesterday"),d=burstLocalizeString("Previous 7 days"),l=burstLocalizeString("Previous 30 days"),u=burstLocalizeString("Previous 90 days"),c=burstLocalizeString("Previous Month")+" ("+moment().subtract(1,"month").format("MMMM")+")",b={};b[o]=[r,i],b[d]=[moment().subtract(8,"days"),i],b[l]=[moment().subtract(32,"days"),i],b[u]=[moment().subtract(92,"days"),i],b[c]=[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")];let m=parseInt(t("input[name=burst_date_start]").val()),g=parseInt(t("input[name=burst_date_end]").val());null!==m&&null!==g||(m=moment().endOf("day").subtract(8,"days").unix(),g=moment().endOf("day").subtract(1,"day").unix());m=parseInt(m),g=parseInt(g),n(moment.unix(m),moment.unix(g)),a(),t(".burst-date-container.burst-date-range").daterangepicker({ranges:b,locale:{format:burstLocalizeString("date_format","burst"),separator:" - ",applyLabel:burstLocalizeString("Apply","burst"),cancelLabel:burstLocalizeString("Cancel","burst"),fromLabel:burstLocalizeString("From","burst"),toLabel:burstLocalizeString("To","burst"),customRangeLabel:burstLocalizeString("Custom","burst"),weekLabel:burstLocalizeString("W","burst"),daysOfWeek:[burstLocalizeString("Su","burst"),burstLocalizeString("Mo","burst"),burstLocalizeString("Tu","burst"),burstLocalizeString("We","burst"),burstLocalizeString("Th","burst"),burstLocalizeString("Fr","burst"),burstLocalizeString("Sa","burst")],monthNames:[burstLocalizeString("January"),burstLocalizeString("February"),burstLocalizeString("March"),burstLocalizeString("April"),burstLocalizeString("May"),burstLocalizeString("June"),burstLocalizeString("July"),burstLocalizeString("August"),burstLocalizeString("September"),burstLocalizeString("October"),burstLocalizeString("November"),burstLocalizeString("December")],firstDay:1},alwaysShowCalendars:!0,startDate:moment.unix(m),endDate:moment.unix(g),opens:"left",maxDate:s},(function(s,r,i){n(s,r),a(s.unix(),r.unix()),t("input[name=burst_date_start]").val(s.unix()),t("input[name=burst_date_end]").val(r.unix()),e(),window.burstLoadAjaxTables()}))}(),t(document).on("change","select[name=burst_selected_metric]",(function(){let e=t(".burst-date-container.burst-date-range").data("daterangepicker"),n=moment(e.startDate),s=moment(e.endDate);a(n.unix(),s.unix())})),e();let s=0;t(window).on("resize",(function(){})),window.burstLoadAjaxTables=function(){t(".burst-grid-datatable").each((function(){0==t(this).find(".burst-skeleton").length&&t(this).find(".burst-grid-content").fadeOut(200,(function(){t(this).html('<div class="burst-skeleton"></div>').fadeIn(300)})),r(t(this),t(this).data("id"),1,0)}))},window.burstLoadAjaxTables();array();function r(a,e,n,i){1===n&&a.html(burst.skeleton);let o=parseInt(t("input[name=burst_date_start]").val()),d=parseInt(t("input[name=burst_date_end]").val()),l=a.data("block_type");t.ajax({type:"GET",url:burst.ajaxurl,dataType:"json",data:{action:"burst_get_datatable",start:o,end:d,page:n,type:l},success:function(o){if(1===n){let n=a.find("table");a.find(".burst-skeleton").fadeOut(300,(function(){n.hide().html(o.html).fadeIn(200),n.DataTable().destroy(),a.find(".dataTables_length").remove(),a.find(".dataTables_filter").remove(),a.find(".dataTables_info").remove(),a.find(".dataTables_paginate").remove(),function(a,e){t(window),a.DataTable({id:e,pageLength:10,pagingType:"simple_numbers",conditionalPaging:!0,columns:[{width:"75%"},{width:"25%"}],language:{paginate:{previous:burstLocalizeString("Previous"),next:burstLocalizeString("Next")},searchPlaceholder:burstLocalizeString("Search"),search:"",emptyTable:burstLocalizeString("No data available")},order:[[1,"desc"]]}),a.on("page.dt",(function(){let a=t(this).closest("table").DataTable().page.info();s=a.page}))}(n,e),a.find(".dataTables_length").appendTo(a.find(".burst-grid-controls")),a.find(".dataTables_filter").appendTo(a.find(".burst-grid-controls")),a.find(".dataTables_info").appendTo(a.find(".burst-grid-footer")),a.find(".dataTables_paginate").appendTo(a.find(".burst-grid-footer"))}))}else{let e=a.find("table").DataTable(),n=o.html.length;for(let a in o.html)if(o.html.hasOwnProperty(a)){let r=t(o.html[a]);parseInt(a)>=n-1?(e.row.add(r).draw(),e.page(s).draw(!1)):e.row.add(r)}}i+=o.batch,o.total_rows>i?(n++,r(a,n,i)):n=1}})}}));
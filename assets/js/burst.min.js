(()=>{var e,t;e=this,t=()=>{let e={startStopTimes:{},idleTimeoutMs:3e4,currentIdleTimeMs:0,checkIdleStateRateMs:250,isUserCurrentlyOnPage:!0,isUserCurrentlyIdle:!1,currentPageName:"default-page-name",timeElapsedCallbacks:[],userLeftCallbacks:[],userReturnCallbacks:[],trackTimeOnElement:t=>{let n=document.getElementById(t);n&&(n.addEventListener("mouseover",(()=>{e.startTimer(t)})),n.addEventListener("mousemove",(()=>{e.startTimer(t)})),n.addEventListener("mouseleave",(()=>{e.stopTimer(t)})),n.addEventListener("keypress",(()=>{e.startTimer(t)})),n.addEventListener("focus",(()=>{e.startTimer(t)})))},getTimeOnElementInSeconds:t=>e.getTimeOnPageInSeconds(t)||0,startTimer:(t,n)=>{if(t||(t=e.currentPageName),void 0===e.startStopTimes[t])e.startStopTimes[t]=[];else{let n=e.startStopTimes[t],i=n[n.length-1];if(void 0!==i&&void 0===i.stopTime)return}e.startStopTimes[t].push({startTime:n||new Date,stopTime:void 0})},stopAllTimers:()=>{let t=Object.keys(e.startStopTimes);for(let n=0;n<t.length;n++)e.stopTimer(t[n])},stopTimer:(t,n)=>{t||(t=e.currentPageName);let i=e.startStopTimes[t];void 0!==i&&0!==i.length&&void 0===i[i.length-1].stopTime&&(i[i.length-1].stopTime=n||new Date)},getTimeOnCurrentPageInSeconds:()=>e.getTimeOnPageInSeconds(e.currentPageName),getTimeOnPageInSeconds:t=>{let n=e.getTimeOnPageInMilliseconds(t);return void 0===n?void 0:n/1e3},getTimeOnCurrentPageInMilliseconds:()=>e.getTimeOnPageInMilliseconds(e.currentPageName),getTimeOnPageInMilliseconds:t=>{let n=0,i=e.startStopTimes[t];if(void 0===i)return;let r=0;for(let e=0;e<i.length;e++){let t=i[e].startTime,n=i[e].stopTime;void 0===n&&(n=new Date),r+=n-t}return n=Number(r),n},getTimeOnAllPagesInSeconds:()=>{let t=[],n=Object.keys(e.startStopTimes);for(let i=0;i<n.length;i++){let r=n[i],o=e.getTimeOnPageInSeconds(r);t.push({pageName:r,timeOnPage:o})}return t},setIdleDurationInSeconds:t=>{let n=parseFloat(t);if(!1!==isNaN(n))throw{name:"InvalidDurationException",message:"An invalid duration time ("+t+") was provided."};e.idleTimeoutMs=1e3*t},setCurrentPageName:t=>{e.currentPageName=t},resetRecordedPageTime:t=>{delete e.startStopTimes[t]},resetAllRecordedPageTimes:()=>{let t=Object.keys(e.startStopTimes);for(let n=0;n<t.length;n++)e.resetRecordedPageTime(t[n])},userActivityDetected:()=>{e.isUserCurrentlyIdle&&e.triggerUserHasReturned(),e.resetIdleCountdown()},resetIdleCountdown:()=>{e.isUserCurrentlyIdle=!1,e.currentIdleTimeMs=0},callWhenUserLeaves:(t,n)=>{e.userLeftCallbacks.push({callback:t,numberOfTimesToInvoke:n})},callWhenUserReturns:(t,n)=>{e.userReturnCallbacks.push({callback:t,numberOfTimesToInvoke:n})},triggerUserHasReturned:()=>{if(!e.isUserCurrentlyOnPage){e.isUserCurrentlyOnPage=!0,e.resetIdleCountdown();for(let t=0;t<e.userReturnCallbacks.length;t++){let n=e.userReturnCallbacks[t],i=n.numberOfTimesToInvoke;(isNaN(i)||void 0===i||i>0)&&(n.numberOfTimesToInvoke-=1,n.callback())}}e.startTimer()},triggerUserHasLeftPageOrGoneIdle:()=>{if(e.isUserCurrentlyOnPage){e.isUserCurrentlyOnPage=!1;for(let t=0;t<e.userLeftCallbacks.length;t++){let n=e.userLeftCallbacks[t],i=n.numberOfTimesToInvoke;(isNaN(i)||void 0===i||i>0)&&(n.numberOfTimesToInvoke-=1,n.callback())}}e.stopAllTimers()},callAfterTimeElapsedInSeconds:(t,n)=>{e.timeElapsedCallbacks.push({timeInSeconds:t,callback:n,pending:!0})},checkIdleState:()=>{for(let t=0;t<e.timeElapsedCallbacks.length;t++)e.timeElapsedCallbacks[t].pending&&e.getTimeOnCurrentPageInSeconds()>e.timeElapsedCallbacks[t].timeInSeconds&&(e.timeElapsedCallbacks[t].callback(),e.timeElapsedCallbacks[t].pending=!1);!1===e.isUserCurrentlyIdle&&e.currentIdleTimeMs>e.idleTimeoutMs?(e.isUserCurrentlyIdle=!0,e.triggerUserHasLeftPageOrGoneIdle()):e.currentIdleTimeMs+=e.checkIdleStateRateMs},visibilityChangeEventName:void 0,hiddenPropName:void 0,listenForVisibilityEvents:(t,n)=>{t&&e.listenForUserLeavesOrReturnsEvents(),n&&e.listForIdleEvents()},listenForUserLeavesOrReturnsEvents:()=>{void 0!==document.hidden?(e.hiddenPropName="hidden",e.visibilityChangeEventName="visibilitychange"):void 0!==document.mozHidden?(e.hiddenPropName="mozHidden",e.visibilityChangeEventName="mozvisibilitychange"):void 0!==document.msHidden?(e.hiddenPropName="msHidden",e.visibilityChangeEventName="msvisibilitychange"):void 0!==document.webkitHidden&&(e.hiddenPropName="webkitHidden",e.visibilityChangeEventName="webkitvisibilitychange"),document.addEventListener(e.visibilityChangeEventName,(()=>{document[e.hiddenPropName]?e.triggerUserHasLeftPageOrGoneIdle():e.triggerUserHasReturned()}),!1),window.addEventListener("blur",(()=>{e.triggerUserHasLeftPageOrGoneIdle()})),window.addEventListener("focus",(()=>{e.triggerUserHasReturned()}))},listForIdleEvents:()=>{document.addEventListener("mousemove",(()=>{e.userActivityDetected()})),document.addEventListener("keyup",(()=>{e.userActivityDetected()})),document.addEventListener("touchstart",(()=>{e.userActivityDetected()})),window.addEventListener("scroll",(()=>{e.userActivityDetected()})),setInterval((()=>{!0!==e.isUserCurrentlyIdle&&e.checkIdleState()}),e.checkIdleStateRateMs)},websocket:void 0,websocketHost:void 0,setUpWebsocket:t=>{if(window.WebSocket&&t){let n=t.websocketHost;try{e.websocket=new WebSocket(n),window.onbeforeunload=()=>{e.sendCurrentTime(t.appId)},e.websocket.onopen=()=>{e.sendInitWsRequest(t.appId)},e.websocket.onerror=e=>{console&&console.log("Error occurred in websocket connection: "+e)},e.websocket.onmessage=e=>{console&&console.log(e.data)}}catch(e){console&&console.error("Failed to connect to websocket host.  Error:"+e)}}},websocketSend:t=>{e.websocket.send(JSON.stringify(t))},sendCurrentTime:t=>{let n={type:"INSERT_TIME",appId:t,timeOnPageMs:e.getTimeOnCurrentPageInMilliseconds(),pageName:e.currentPageName};e.websocketSend(n)},sendInitWsRequest:t=>{let n={type:"INIT",appId:t};e.websocketSend(n)},initialize:t=>{let n,i,r=e.idleTimeoutMs||30,o=e.currentPageName||"default-page-name",s=!0,a=!0;t&&(r=t.idleTimeoutInSeconds||r,o=t.currentPageName||o,n=t.websocketOptions,i=t.initialStartTime,!1===t.trackWhenUserLeavesPage&&(s=!1),!1===t.trackWhenUserGoesIdle&&(a=!1)),e.setIdleDurationInSeconds(r),e.setCurrentPageName(o),e.setUpWebsocket(n),e.listenForVisibilityEvents(s,a),e.startTimer(void 0,i)}};return e},"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],(()=>e.TimeMe=t())):e.TimeMe=t()}).call(this),TimeMe.initialize({idleTimeoutInSeconds:30});let token="?token="+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,7),insert_id=!1,ticking=!1;function burst_track_hit(e){if(burst_is_user_agent())return;let t={url:location.pathname,entire_url:location.href,page_id:burst.page_id,referrer_url:document.referrer,user_agent:navigator.userAgent,device_resolution:window.screen.width*window.devicePixelRatio+"x"+window.screen.height*window.devicePixelRatio,time_on_page:TimeMe.getTimeOnCurrentPageInMilliseconds()},n=new CustomEvent("burst_track_hit",{detail:t});document.dispatchEvent(n);let i=new XMLHttpRequest;i.open("POST",burst.url+"hit"+token,!0),i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(t)),i.onload=function(e){if(4===i.readyState)if(200===i.status){let e;e=JSON.parse(i.response),insert_id=e.insert_id}else console.error(i.statusText)},i.onerror=function(e){console.error(i.statusText)},"function"==typeof e&&e()}document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&burst_update_time_on_page()})),window.addEventListener("pagehide",burst_update_time_on_page,!1),window.addEventListener("beforeunload",burst_update_time_on_page,!1),TimeMe.callWhenUserLeaves(burst_update_time_on_page),document.addEventListener("DOMContentLoaded",(function(){burst_track_hit()})),document.addEventListener("burst_fire_hit",(function(){burst_track_hit()}));let burst_last_time_update=!1;function burst_update_time_on_page(e){if(burst_is_user_agent())return;if(!insert_id)return;let t=TimeMe.getTimeOnCurrentPageInMilliseconds();if(burst_last_time_update+1e3>t)return;burst_last_time_update=t;let n={ID:insert_id,time_on_page:t},i=new XMLHttpRequest;i.open("POST",burst.url+"time"+token,!0),i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(n)),i.onerror=function(e){console.error(i.statusText)},"function"==typeof callback&&callback()}function burst_is_user_agent(){let e=new RegExp("(googlebot/|bot|Googlebot-Mobile|Googlebot-Image|Google favicon|Mediapartners-Google|bingbot|slurp|java|wget|curl|Commons-HttpClient|Python-urllib|libwww|httpunit|nutch|phpcrawl|msnbot|jyxobot|FAST-WebCrawler|FAST Enterprise Crawler|biglotron|teoma|convera|seekbot|gigablast|exabot|ngbot|ia_archiver|GingerCrawler|webmon |httrack|webcrawler|grub.org|UsineNouvelleCrawler|antibot|netresearchserver|speedy|fluffy|bibnum.bnf|findlink|msrbot|panscient|yacybot|AISearchBot|IOI|ips-agent|tagoobot|MJ12bot|dotbot|woriobot|yanga|buzzbot|mlbot|yandexbot|purebot|Linguee Bot|Voyager|CyberPatrol|voilabot|baiduspider|citeseerxbot|spbot|twengabot|postrank|turnitinbot|scribdbot|page2rss|sitebot|linkdex|Adidxbot|blekkobot|ezooms|dotbot|Mail.RU_Bot|discobot|heritrix|findthatfile|europarchive.org|NerdByNature.Bot|sistrix crawler|ahrefsbot|Aboundex|domaincrawler|wbsearchbot|summify|ccbot|edisterbot|seznambot|ec2linkfinder|gslfbot|aihitbot|intelium_bot|facebookexternalhit|yeti|RetrevoPageAnalyzer|lb-spider|sogou|lssbot|careerbot|wotbox|wocbot|ichiro|DuckDuckBot|lssrocketcrawler|drupact|webcompanycrawler|acoonbot|openindexspider|gnam gnam spider|web-archive-net.com.bot|backlinkcrawler|coccoc|integromedb|content crawler spider|toplistbot|seokicks-robot|it2media-domain-crawler|ip-web-crawler.com|siteexplorer.info|elisabot|proximic|changedetection|blexbot|arabot|WeSEE:Search|niki-bot|CrystalSemanticsBot|rogerbot|360Spider|psbot|InterfaxScanBot|Lipperhey SEO Service|CC Metadata Scaper|g00g1e.net|GrapeshotCrawler|urlappendbot|brainobot|fr-crawler|binlar|SimpleCrawler|Livelapbot|Twitterbot|cXensebot|smtbot|bnf.fr_bot|A6-Indexer|ADmantX|Facebot|Twitterbot|OrangeBot|memorybot|AdvBot|MegaIndex|SemanticScholarBot|ltx71|nerdybot|xovibot|BUbiNG|Qwantify|archive.org_bot|Applebot|TweetmemeBot|crawler4j|findxbot|SemrushBot|yoozBot|lipperhey|y!j-asr|Domain Re-Animator Bot|AddThis)","i"),t=navigator.userAgent;return e.test(t)}function burst_get_cookie(e){e+="=";let t=window.document.cookie.split(";");for(let n=0;n<t.length;n++){let i=t[n].trim();if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""}function burst_set_cookie(e,t){let n="",i=";secure",r=new Date,o=burst.cookie_retention_days;r.setTime(r.getTime()+24*o*60*60*1e3);let s=";expires="+r.toGMTString();"https:"!==window.location.protocol&&(i=""),n.length>0&&(n=";domain="+n),document.cookie=e+"="+t+";SameSite=Lax"+i+s+n+";path=/"}